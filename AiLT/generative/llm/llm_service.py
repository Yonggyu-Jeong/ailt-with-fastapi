import torch
from transformers import pipeline, AutoModelForCausalLM
from generative.llm.llm_def import pipe, model

# TODO torch 및 cuda setup
print(torch.cuda.is_available())
model.eval()


def ask(x, context='', is_input_full=False):
    ans = pipe(
        f"### 질문: {x}\n\n### 맥락: {context}\n\n### 답변:" if context else f"### 질문: {x}\n\n### 답변:",
        do_sample=True,
        max_new_tokens=512,
        temperature=0.7,
        top_p=0.9,
        return_full_text=False,
        eos_token_id=2,
    )
    print(ans[0]['generated_text'])
